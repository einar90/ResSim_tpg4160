PROGRAM EXPLICIT
!
!-----DECLARATIONS
!      
      REAL P(25),PNEW(25),X(25),A(25),B(25),C(25),D(25)
      REAL POR,PERM,VISC,COMPR,L,PL,PR,PINIT,DT,TMAX,PI,DX
!
!-----INITIALISATION OF PARAMETERS
!
      DATA POR/0.2/,PERM/1.0/,VISC/1.0/,COMPR/0.0001/,L/100./,PL/2.0/ &
      ,PR/1.0/PINIT/1.0/,DT/0.00025/,N/10/,TMAX/0.2/,IPRINT/1/
      INTEGER ISW,I,N,J
      DATA PI/3.14159/

   31 DX=L/N
      T=0.
      CONST=DT/DX/DX*PERM/POR/VISC/COMPR
      ALPHA=1./CONST
      ISW=0
      DO 5 I=1,N
      P(I)=PINIT
      PNEW(I)=PINIT
    5 X(I)=L*I/N-L/N/2.
!
!-----OPEN OUTPUT FILE
!
      OPEN(10,FILE='explicitOutput',STATUS='UNKNOWN')
!
!-----TIME LOOP
!
      DO 200 J=1,1000
      ISW=ISW+1
      T=T+DT
!
!-----EXPLICIT SOLUTION
!
      PNEW(1)=P(1)+CONST*(P(2)-3.0*P(1)+2.0*PL)
      PNEW(N)=P(N)+CONST*(2.0*PR-3.0*P(N)+P(N-1))
      DO 7 I=2,N-1
    7 PNEW(I)=P(I)+CONST*(P(I+1)-2.0*P(I)+P(I-1))
!
!-----PRINT (?)
!
      IF(ISW.NE.IPRINT)GO TO 99
      ISW=0
      WRITE(10,100)T,PL,(PNEW(I),I=1,N),PR
  100 FORMAT(50F10.4)
   99 CONTINUE      
!
!-----END (?)
!
      IF(T.GE.TMAX)STOP
!
!-----UPDATING OF PRESSURES
!
   13 DO 14 I=1,N
   14 P(I)=PNEW(I)
  200 CONTINUE

END PROGRAM

